\begin{frame}[fragile]{Lattices Automate Filling of Repetitive Structures}

  \begin{scriptsize}
    \begin{lstlisting}[language=XML,gobble=4]
      <?xml version="1.0" encoding="UTF-8"?>
      <geometry>

        <!-- Fuel Rod Pincell Universe -->
        <surface id="1"  type="z-cylinder" coeffs="0.0 0.0 0.39218"/>     <!-- fuel OR   -->
        <surface id="2"  type="z-cylinder" coeffs="0.0 0.0 0.40005"/>     <!-- gap OR    -->
        <surface id="3"  type="z-cylinder" coeffs="0.0 0.0 0.45720"/>     <!-- clad OR   -->
        <cell id="21" universe="2" material="2" surfaces="  -1"/>         <!-- fuel  -->
        <cell id="22" universe="2" material="3" surfaces="1 -2"/>         <!-- clad  -->
        <cell id="23" universe="2" material="1" surfaces="   2"/>         <!-- water -->

        <!-- Pin-Lattice -->
        <lattice id="100" type="rectangular" dimension="2 2">
          <lower_left> -1.25984 -1.25984 </lower_left>
          <width> 1.25984 1.25984 </width>
          <universes>
            2 2
            2 2
          </universes>
        </lattice>
        <surface id="99" type="sphere" coeffs="0.0 0.0 0.0 400.0"/>
        <cell id="1000" universe="0" fill="100" surfaces="-99"/>

      </geometry>
    \end{lstlisting}
  \end{scriptsize}


  \begin{itemize}
    \item \small Lattices set up a grid of cells filled by other universes, handling
    fill translation automatically
    \item \small Lattices are themselves very similar to universes - to use them, other
    cells must be filled with them
  \end{itemize}
  
  
  \onslide<2>{
    \setlength{\TPHorizModule}{\framewidth}
    \setlength{\TPVertModule}{\paperheight}
    \begin{textblock}{1}(0.67,-0.37)
      \begin{tikzpicture}
        \draw[red,thick,->](1,0) node (la) [,anchor=west] {Bad!} -- (.2,0);
        \node[red,anchor=north] at (la.south) {\footnotesize There is undefined space!};
        \node[red,anchor=south] at (la.north) {\footnotesize No boundary condition!};
      \end{tikzpicture}
    \end{textblock}
  }
  
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Lattice Example}


  \begin{scriptsize}
    \begin{lstlisting}[language=XML,gobble=4]
      <?xml version="1.0" encoding="UTF-8"?>
      <geometry>

        <!-- Fuel Rod Pincell Universe -->
        <surface id="1"  type="z-cylinder" coeffs="0.0 0.0 0.39218"/>     <!-- fuel OR   -->
        <surface id="2"  type="z-cylinder" coeffs="0.0 0.0 0.40005"/>     <!-- gap OR    -->
        <surface id="3"  type="z-cylinder" coeffs="0.0 0.0 0.45720"/>     <!-- clad OR   -->
        <cell id="21" universe="2" material="2" surfaces="  -1"/>         <!-- fuel  -->
        <cell id="22" universe="2" material="3" surfaces="1 -2"/>         <!-- clad  -->
        <cell id="23" universe="2" material="1" surfaces="   2"/>         <!-- water -->

        <!-- Pin-Lattice -->
        <lattice id="100" type="rectangular" dimension="2 2">
          <lower_left> -1.25984 -1.25984 </lower_left>
          <width> 1.25984 1.25984 </width>
          <universes>
            2 2
            2 2
          </universes>
        </lattice>
        
        <!-- Main Universe -->
        <surface id="4"  type="x-plane" coeffs="-1.25984" boundary="reflective"/>
        <surface id="5"  type="x-plane" coeffs=" 1.25984" boundary="reflective"/>
        <surface id="6"  type="y-plane" coeffs="-1.25984" boundary="reflective"/>
        <surface id="7"  type="y-plane" coeffs=" 1.25984" boundary="reflective"/>
        <surface id="8"  type="z-plane" coeffs="-5.00000" boundary="reflective"/>
        <surface id="9"  type="z-plane" coeffs=" 5.00000" boundary="reflective"/>
        <cell id="1" universe="0" fill="100" surfaces="4 -5 6 -7 8 -9"/>
        
      </geometry>
    \end{lstlisting}
  \end{scriptsize}

  \onslide<1>{
    \setlength{\TPHorizModule}{\framewidth}
    \setlength{\TPVertModule}{\paperheight}
    \begin{textblock}{1}(0.86,-0.265)
      \begin{tikzpicture}
        \draw[green,thick,->](0.3,0) node[anchor=west] {Good!} -- (0,0);
        \draw[green] (-0.1,-.7) -- (0,-.7) -- (0,.8) -- (-0.1,.8);
      \end{tikzpicture}
    \end{textblock}
  }
  \onslide<2>{
    \setlength{\TPHorizModule}{\framewidth}
    \setlength{\TPVertModule}{\paperheight}
    \begin{textblock}{1}(0.635,-0.6)
      \begin{tikzpicture}
        \begin{scope}[shift={(-1,-1)}]
          \draw[fill=blue!70!white] (-1,-1) rectangle (1,1);
          \draw[fill=gray] (0,0) circle (0.7258);
          \draw[fill=yellow] (0,0) circle (0.63508);
          \draw[fill=red] (0,0) circle (0.62250);
        \end{scope}
        \begin{scope}[shift={(1,-1)}]
          \draw[fill=blue!70!white] (-1,-1) rectangle (1,1);
          \draw[fill=gray] (0,0) circle (0.7258);
          \draw[fill=yellow] (0,0) circle (0.63508);
          \draw[fill=red] (0,0) circle (0.62250);
        \end{scope}
        \begin{scope}[shift={(-1,1)}]
          \draw[fill=blue!70!white] (-1,-1) rectangle (1,1);
          \draw[fill=gray] (0,0) circle (0.7258);
          \draw[fill=yellow] (0,0) circle (0.63508);
          \draw[fill=red] (0,0) circle (0.62250);
        \end{scope}
        \begin{scope}[shift={(1,1)}]
          \draw[fill=blue!70!white] (-1,-1) rectangle (1,1);
          \draw[fill=gray] (0,0) circle (0.7258);
          \draw[fill=yellow] (0,0) circle (0.63508);
          \draw[fill=red] (0,0) circle (0.62250);
        \end{scope}
      \end{tikzpicture}
    \end{textblock}
  }
  

\end{frame}
